<!DOCTYPE html>
<html lang="zh-CN" prefix="og: https://ogp.me/ns#">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>限时福利领取</title>
    
    <!-- 双平台OG标签 -->
    <meta property="og:title" content="【独家优惠】点击领取微信/抖音双重福利">
    <meta property="og:image" content="https://your-domain.com/og-image.jpg">
    
    <!-- 安全策略 -->
    <meta name="referrer" content="no-referrer">
    
    <style>
        body { margin: 0; padding: 20px; background: #fff; font-family: -apple-system, sans-serif; }
        .container { text-align: center; max-width: 320px; margin: 0 auto; }
        .coupon-image {
            width: 100%;
            height: 160px;
            background: url('https://your-domain.com/og-image.jpg') center/cover no-repeat;
            border-radius: 8px;
            margin-bottom: 20px;
        }
        .jump-btn {
            display: block;
            padding: 12px 24px;
            background: linear-gradient(135deg, #07C160, #05a854);
            color: white;
            border-radius: 25px;
            text-decoration: none;
            font-weight: 500;
            animation: btnBreath 1.5s infinite;
        }
        @keyframes btnBreath {
            0%, 100% { transform: scale(1); }
            50% { transform: scale(1.05); }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="coupon-image"></div>
        <a href="javascript:void(0);" class="jump-btn" id="smartJump">立即领取福利</a>
    </div>

    <script>
        // 安全跳转系统（优化版）
        const SMART_JUMP = {
            // 跳转配置
            schemes: {
                wechat: {
                    ios: 'weixin://dl/business/?ticket=xxxx',
                    android: 'intent://#Intent;package=com.tencent.mm;scheme=weixin;end;',
                    fallback: 'https://work.weixin.qq.com'
                },
                douyin: {
                    ios: 'snssdk1128://aweme/detail/123456789',
                    android: 'intent://com.ss.android.ugc.aweme/#Intent;scheme=snssdk1128;package=com.ss.android.ugc.aweme;end',
                    fallback: 'https://www.douyin.com'
                }
            },
            
            // 初始化
            init: function() {
                const btn = document.getElementById('smartJump');
                btn.addEventListener('click', (e) => {
                    e.preventDefault();
                    this.handleClick();
                });
            },
            
            // 处理点击
            handleClick: function() {
                const platform = this.detectPlatform();
                const isAndroid = /android/i.test(navigator.userAgent);
                const scheme = this.schemes[platform];
                const url = isAndroid ? scheme.android : scheme.ios;
                
                // 第一步：尝试iframe跳转（静默）
                this.silentRedirect(url);
                
                // 第二步：延迟兜底跳转
                setTimeout(() => {
                    window.location = scheme.fallback;
                }, 800);
            },
            
            // 静默跳转
            silentRedirect: function(url) {
                try {
                    // 方法1：iframe跳转
                    const iframe = document.createElement('iframe');
                    iframe.style.display = 'none';
                    iframe.src = url;
                    document.body.appendChild(iframe);
                    
                    // 方法2：尝试window.open
                    setTimeout(() => {
                        window.open(url, '_blank');
                    }, 300);
                } catch(e) {
                    console.log('安全跳转异常:', e);
                }
            },
            
            // 平台检测
            detectPlatform: function() {
                const ua = navigator.userAgent;
                if(ua.match(/MicroMessenger/i)) return 'wechat';
                if(ua.match(/douyin|aweme/i)) return 'douyin';
                return 'wechat'; // 默认
            }
        };
        
        // 启动系统
        setTimeout(() => SMART_JUMP.init(), 500);
    </script>
</body>
</html>
